This flow showcases role-based access control at the reading circle level.

The ADMIN can:
- remove members from the circle
- change members' roles
- edit the circle name and description
- delete messages

The MODERATOR can:
- edit the circle description
- delete non-admin messages



mutation loginOwner{
  login(input:{
    name: "Mike Tyson",
    password: "password"
  }){
    ... on LoggedInUserType{
      id,
      token
    }
    ... on FailedAuthenticationType{
      reason
    }
  }
}


mutation createReadingCircle{
  createReadingCircle(input:{
    name: "Club SF",
    description: "Fahrenheit 451 type shit"
  }){
    id,
    name,
    description,
    owner {
      id,
      name,
      email
    }
  }
}


mutation registerUser{
  register(input:{
    name: "Laur",
    password: "password",
    email: "laur@gmail.com",
    age: 20,
    country: "Romania",
    bio: "I read sometimes on the train. I like classical books."
  }){
    ... on LoggedInUserType{
      id,
      token
    }
    ... on FailedAuthenticationType{
      reason
    }
  }
}


mutation loginAnotherUser{
  login(input:{
    name: "Laur",
    password: "password"
  }){
    ... on LoggedInUserType{
      id,
      token
    }
    ... on FailedAuthenticationType{
      reason
    }
  }
}


mutation requestJoinCircle{
  requestJoinCircle(input:{
    circleId: 22
  }){
    id,
    status,
    circleId,
    role,
    user {
      id,
      name,
      email
    },
    requestedAt
  }
}


query getPendingRequests{
  pendingRequests(circleId: 22){
    id,
    status,
    circleId,
    role,
    user {
      id,
      name,
      email
    },
    requestedAt
  }
}


mutation acceptJoinRequest{
  respondJoinRequest(input:{
    requestId: 304,
    action: "accept"
  }){
    id,
    status,
    role,
    user {
      id,
      name,
      email
    },
    requestedAt,
    respondedAt
  }
}
 
query showReadingCircleMembers{
  readingCircleMembers(circleId: 22){
    id,
    user{
      name,
      email
    },
    role,
    status
  }
}

mutation deleteReadingCircleMember{
  deleteReadingCircleMember(memberId: 304)
}


mutation changeMemberRole{
  updateReadingCircleMemberRole(
    memberId: 305,
    role: MODERATOR
  ){
    id,
    status,
    role,
    user {
      id,
      name,
      email
    },
    requestedAt,
    respondedAt
  }
}


query showMyCircles{
  myCircles{
    name
    description
    id
  }
}


mutation updateReadingCircle{
  updateReadingCircle(
    input:{
      id: 22,
      name: "A new name",
      description: "A new description"
    }
  ){
    id
    name
    description
  }
}


mutation dissolveReadingCircleMutation{
  dissolveReadingCircle(circleId: 22)
}

mutation exitReadingCircleMutation{
  exitReadingCircle(circleId: 22)
}